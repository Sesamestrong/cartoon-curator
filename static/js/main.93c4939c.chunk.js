(this.webpackJsonprunner=this.webpackJsonprunner||[]).push([[0],{179:function(t,e,a){t.exports=a(477)},184:function(t,e,a){},476:function(t,e,a){},477:function(t,e,a){"use strict";a.r(e);var n=a(7),r=a.n(n),i=a(178),s=a.n(i),c=(a(184),a(185),a(187),a(188),a(189),a(190),a(191),a(192),a(193),a(194),a(195),a(196),a(197),a(198),a(199),a(200),a(201),a(202),a(203),a(204),a(205),a(206),a(207),a(208),a(209),a(210),a(211),a(212),a(82),a(213),a(214),a(215),a(216),a(217),a(218),a(219),a(220),a(221),a(222),a(223),a(224),a(225),a(226),a(227),a(228),a(230),a(231),a(233),a(234),a(236),a(237),a(238),a(239),a(118),a(240),a(241),a(242),a(243),a(244),a(245),a(246),a(247),a(248),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(259),a(260),a(261),a(262),a(263),a(264),a(265),a(266),a(267),a(268),a(269),a(270),a(271),a(272),a(273),a(274),a(275),a(276),a(277),a(278),a(279),a(280),a(281),a(282),a(283),a(284),a(285),a(286),a(287),a(288),a(289),a(290),a(291),a(293),a(294),a(295),a(296),a(297),a(298),a(299),a(301),a(302),a(303),a(304),a(305),a(306),a(307),a(308),a(309),a(310),a(311),a(164),a(312),a(313),a(166),a(314),a(315),a(316),a(317),a(167),a(318),a(319),a(320),a(321),a(322),a(323),a(324),a(325),a(326),a(327),a(328),a(329),a(330),a(331),a(332),a(333),a(334),a(335),a(336),a(337),a(338),a(339),a(340),a(341),a(342),a(343),a(345),a(346),a(347),a(348),a(349),a(350),a(351),a(352),a(353),a(354),a(355),a(356),a(357),a(358),a(359),a(360),a(361),a(362),a(363),a(364),a(365),a(366),a(367),a(368),a(369),a(370),a(371),a(372),a(373),a(374),a(375),a(376),a(377),a(126),a(378),a(379),a(380),a(381),a(382),a(383),a(384),a(386),a(387),a(388),a(389),a(390),a(391),a(392),a(393),a(395),a(396),a(397),a(398),a(399),a(400),a(401),a(402),a(403),a(404),a(405),a(406),a(407),a(408),a(409),a(410),a(411),a(412),a(413),a(414),a(415),a(416),a(417),a(418),a(419),a(421),a(422),a(423),a(424),a(425),a(426),a(427),a(428),a(429),a(430),a(431),a(432),a(433),a(434),a(435),a(436),a(437),a(438),a(439),a(440),a(441),a(442),a(443),a(444),a(445),a(446),a(447),a(448),a(449),a(450),a(451),a(452),a(454),a(455),a(456),a(457),a(458),a(459),a(460),a(461),a(462),a(463),a(464),a(465),a(466),a(467),a(468),a(469),a(471),a(177),a(46)),o=a(47),u=a(49),l=a(48),d=a(50),p=window.location.origin.startsWith("http://localhost:")?"http://localhost:3000":"https://api.freecomics.ml";function m(t){return unescape(document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)"+t+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))}a(472);var h=a(127),v=a(77),f=a(51),b=a(56),g=a.n(b),k=a(38),y=a.n(k),j=a(97),O=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={strips:{Select:""}},a.findStrips(),a}return Object(d.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("select",{className:"comic-choice",onChange:function(e){return t.props.updateValue(Object(f.a)({name:e.target.value},t.state.strips[e.target.value]))}},Object.keys(this.state.strips).sort((function(t,e){return e>t})).map((function(t){return r.a.createElement("option",{key:t,value:t},t)})))}},{key:"findStrips",value:function(){var t,e,a,n,r;return y.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,y.a.awrap(fetch("".concat(p,"/api/").concat("v1","/ids")));case 2:return t=i.sent,i.next=5,y.a.awrap(t.json());case 5:for(t=i.sent,e={Select:[null,null]},a=function(){var a=r[n],i=t[a];console.log(i);var s=i.reduce((function(t,e){return Object(f.a)({},t,Object(j.a)({},e,{id:e,provider:a}))}),{});e=Object(f.a)({},e,{},s)},n=0,r=Object.keys(t);n<r.length;n++)a();console.log(e),this.setState({strips:e});case 11:case"end":return i.stop()}}),null,this)}}]),e}(n.Component),E=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={date:a.props.date||"",strips:{},shown:!0,id:a.props.id,name:void 0,provider:a.props.provider},a}return Object(d.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){this.state.id&&this.findUrl(this.state.date)}},{key:"componentDidUpdate",value:function(){this.findUrl()}},{key:"render",value:function(){var t=this;console.log("render");var e=this.state.strips[this.state.date]||{};return""!==this.state.date&&this.state.id?e.url?r.a.createElement("div",{className:"comic-container"},r.a.createElement("h2",null,this.state.name),r.a.createElement("p",null,this.state.date),r.a.createElement("span",{role:"img","aria-label":"Delete",onClick:this.props.remove},"\u274c"),r.a.createElement("div",{className:"comic"},r.a.createElement("link",{ref:"previous",rel:"preload",as:"image",href:(this.state.strips[e.previous]||{}).url}),r.a.createElement("img",{ref:"this",alt:this.state.name||this.state.id+" comic strip",src:e.url,onClick:function(){return t.props.setDate(e.previous)}}),r.a.createElement("link",{ref:"next",rel:"preload",as:"image",href:(this.state.strips[e.next]||{}).url}),r.a.createElement("div",{className:"overlay"},r.a.createElement("input",{type:"button",onClick:function(){return t.props.setDate(e.previous)},value:"",className:"arrow"}),r.a.createElement("input",{type:"button",onClick:function(){return t.props.setDate(e.next)},value:"",className:"arrow"})))):null:r.a.createElement("div",{className:"input-container"},r.a.createElement(O,{updateValue:function(e){console.log("updateValue",e),t.props.updateVals({id:e.id,name:e.name,provider:e.provider})}}))}},{key:"findUrl",value:function(t){var e,a,n,r,i,s,c,o,u,l,d=this;return y.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(this.state.id&&this.state.provider){m.next=2;break}return m.abrupt("return");case 2:if(this.state.id&&this.state.provider&&!this.state.name&&fetch("".concat(p,"/api/").concat("v1","/").concat(this.state.provider,"/").concat(this.state.id)).then((function(t){return t.json()})).then((function(t){return d.setState({name:t.name})})),t=t||this.state.date,a={},Object.keys(this.state.strips).includes(t)){m.next=17;break}return n=this.getUrl(t),m.next=9,y.a.awrap(fetch(n));case 9:return r=m.sent,m.next=12,y.a.awrap(r.json());case 12:(r=m.sent).error&&console.log(n,"failed"),e=r,m.next=18;break;case 17:e=this.state.strips[t];case 18:a[t]=e,this.state.date!==t&&this.setState({date:t,strips:a}),i=0,s=["previous","next"];case 21:if(!(i<s.length)){m.next=44;break}if(c=s[i],this.state.strips[e[c]]||!e[c]||""===e[c]){m.next=40;break}return o=this.getUrl(e[c]),m.next=27,y.a.awrap(fetch(o));case 27:return u=m.sent,m.prev=28,m.next=31,y.a.awrap(u.json());case 31:u=m.sent,m.next=37;break;case 34:return m.prev=34,m.t0=m.catch(28),m.abrupt("continue",41);case 37:a[e[c]]=u,m.next=41;break;case 40:a[e[c]]=this.state.strips[e[c]];case 41:i++,m.next=21;break;case 44:l=Object.keys(this.state.strips),Object.keys(a).filter((function(t){return!l.includes(t)})).length>0&&this.setState({strips:a});case 46:case"end":return m.stop()}}),null,this,[[28,34]])}},{key:"getUrl",value:function(t){return"".concat(p,"/api/").concat("v1","/").concat(this.state.provider,"/").concat(this.state.id,"/").concat(t)}}],[{key:"getDerivedStateFromProps",value:function(t,e){return t.date!==e.date?{date:t.date}:null}}]),e}(n.Component),D=function(t){function e(t){var a;Object(c.a)(this,e),a=Object(u.a)(this,Object(l.a)(e).call(this,t));var n=new URLSearchParams(window.location.search);a.url=n,a.state={date:["year","month","day"].reduce((function(t,e){return t||!n.get(e)}),!1)?new Date:new Date(n.get("year"),n.get("month")-1,n.get("day")),comics:[]};var r=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return e.reduce((function(t,e){return t.slice(0,e.length).map((function(t,a){return[t,e[a]]}))}))},i=r(n.getAll("comic"),n.getAll("provider"));i=(i=i.length>0?i:r(JSON.parse(m("comic")||"[]"),JSON.parse(m("provider")||"[]"))).length>0?i.map((function(t){return{id:t[0],provider:t[1]}})):[{provider:"gocomics",id:"pearlsbeforeswine"},{provider:"dilbert",id:"dilbert"},{provider:"gocomics",id:"dilbert-classics"},{provider:"xkcd",id:"xkcd"},{provider:"smbc",id:"smbc"},{provider:"comicskingdom",id:"sherman-s-lagoon"},{provider:"comicskingdom",id:"dustin"},{provider:"comicskingdom",id:"rhymes-with-orange"},{provider:"gocomics",id:"lio"},{provider:"gocomics",id:"calvinandhobbes"},{provider:"gocomics",id:"foxtrot"},{provider:"gocomics",id:"garfield"}],a.state.comics=i;var s=g()(a.state.date).format("YYYY/M/D");document.title=g()(a.state.date).format("MMMM D[, ]YYYY");var o=a.state.comics.map((function(t){return Object(f.a)({},t,{date:s})}));return a.state.comics=o,a}return Object(d.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"navBar"},r.a.createElement("button",{onClick:function(){return t.addDays(-1)},className:"changeDate"},"<"),r.a.createElement("h1",{className:"title"},"Cartoon Curator"),r.a.createElement("button",{onClick:function(){return t.addDays(1)},className:"changeDate next"},">")),r.a.createElement("div",{className:"body"},this.state.comics.map((function(e,a){return r.a.createElement(E,{updateVals:function(e){return t.updateValue(a,e)},remove:function(){return t.popComic(a)},setDate:function(e){return t.setDate(a,e)},key:e.id,date:e.date,id:e.id,provider:e.provider})})),r.a.createElement("div",{className:"input-container"},r.a.createElement("input",{type:"button",onClick:function(){return t.addComic()},className:"plus",value:"+"}))))}},{key:"addComic",value:function(){this.setState({comics:[].concat(Object(v.a)(this.state.comics),[{id:"",name:"",date:g()(this.state.date).format("YYYY/M/D")}])})}},{key:"updateValue",value:function(t,e){var a=Object(v.a)(this.state.comics);a[t]=Object.assign({},a[t],e),this.setURL(a),this.setState({comics:a})}},{key:"setDate",value:function(t,e){var a=Object(v.a)(this.state.comics),n=Object(f.a)({},a[t]);n.date=e,a[t]=n,this.setState({comics:a})}},{key:"popComic",value:function(t){var e=Object(v.a)(this.state.comics),a=e.splice(t,1);return this.setState({comics:e}),this.setURL(e),a}},{key:"addDays",value:function(t){var e=new Date(this.state.date);e.setDate(this.state.date.getDate()+t),this.applyDate(e)}},{key:"applyDate",value:function(t){var e=g()(t).format("YYYY/M/D"),a=this.state.comics.map((function(t){return Object(f.a)({},t,{date:e})}));this.setURL(void 0,e),this.setState({date:t,comics:a})}},{key:"setURL",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.date,n=g()(a);if(t){this.url.delete("comic");[["id","comic"],["provider","provider"]].forEach((function(e){var a=Object(h.a)(e,2),n=a[0],r=a[1];document.cookie=r+"="+escape(JSON.stringify(t.map((function(t){return t[n]}))))}))}if(a){var r=[["year","YYYY"],["month","M"],["day","D"]];r.forEach((function(t){var a=Object(h.a)(t,2),r=a[0],i=a[1],s=n.format(i);e.url.set(r,s),document.cookie="".concat(r,"=").concat(s)}))}window.history.pushState(a,g()(a).format("MMMM D[,] YYYY"),"?"+this.url.toString())}}]),e}(n.Component),w=(a(476),function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return r.a.createElement(D,null)}}]),e}(n.Component));s.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[179,1,2]]]);
//# sourceMappingURL=main.93c4939c.chunk.js.map